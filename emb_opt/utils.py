# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/00_utils.ipynb.

# %% auto 0
__all__ = ['whiten', 'pack_dataset']

# %% ../nbs/00_utils.ipynb 3
from .imports import *

# %% ../nbs/00_utils.ipynb 4
def whiten(scores):
    mean = scores.mean()
    var = scores.var()
    
    return (scores - mean) / np.sqrt(var + 1e-8)

# %% ../nbs/00_utils.ipynb 5
def pack_dataset(dataset: Dataset, 
                 index_column: str, 
                 pack_columns: list[str]
                ):
    output = defaultdict(lambda: defaultdict(list))
    
    for row in dataset:
        for col_name in pack_columns:
            output[row[index_column]][col_name].append(row[col_name])
            
    return output
